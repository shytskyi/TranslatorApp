@* @addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers *@

<h1>Audit Log Search </h1>

<!-- 1. Date Range -->
<div class="mb-4">
    <h4>1. Search by Date Range</h4>
    <form id="frmDate" asp-action="ByDateRange" method="get" class="form-inline">
        <input type="date" name="startDate" required class="form-control mr-2" />
        <input type="date" name="endDate" required class="form-control mr-2" />
        <button type="submit" class="btn btn-primary">Search</button>
    </form>
    <div id="resDate" class="mt-3"></div>
</div>

<!-- 2. Method & Status -->
<div class="mb-4">
    <h4>2. Search by Method &amp; Status</h4>
    <form id="frmMethod" asp-action="ByMethodAndStatus" method="get" class="form-inline">
        <input type="text" name="method" placeholder="GET, POST" class="form-control mr-2" />
        <input type="number" placeholder="200, 300, 400, 500" name="statusCode" class="form-control mr-2" />
        <button type="submit" class="btn btn-primary">Search</button>
    </form>
    <div id="resMethod" class="mt-3"></div>
</div>

<!-- 3. Filtered -->
<div class="mb-4">
    <h4>3. Filtered Search</h4>
    <form id="frmPaged" asp-action="Paged" method="get" class="form-inline">
        <input type="text" name="pathFilter" placeholder="/User, /Home, /ApplicationLog, /Authorization" class="form-control mr-2" />
        <input type="number" placeholder="200, 300, 400, 500" name="minStatus" class="form-control mr-2" />
        <button type="submit" class="btn btn-primary">Search</button>
    </form>
    <div id="resPaged" class="mt-3"></div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(function(){
          $('#frmDate').submit(function(e){
            e.preventDefault();
            $.get(this.action, $(this).serialize())
             .done(html => $('#resDate').html(html));
          });
          $('#frmMethod').submit(function(e){
            e.preventDefault();
            $.get(this.action, $(this).serialize())
             .done(html => $('#resMethod').html(html));
          });
          $('#frmPaged').submit(function(e){
            e.preventDefault();
            $.get(this.action, $(this).serialize())
             .done(html => $('#resPaged').html(html));
          });
        });
    </script>
}
